<!doctype html>
<meta charset="utf-8" />
<title>Sonic</title>

<style>
body {background: black;}
</style>

<body>

<script src="../src/sonic.js"></script>
<script>

var start;

var timeout = new Sonic({

    width: 800,
    height: 800,
    padding: 0,

    fillColor: 'rgba(200,255,0,.8)',

    pointDistance: .01,
    time: 10,
    trailLength: 1,

    path: [
        ['line', 40, 30, 150, 30],
        ['arc', 150, 60, 30, -90, 90],
        ['line', 150, 90, 40, 90],
        ['arc', 40, 60, 30, 90, 270],
    ],

    setup: function () {},

    complete: function () {
        this.stop();
        console.log(this.points.length, this.frame);
        console.log('%dms', +(new Date) - start);
    },

    preDraw: function () {},

    step: function(point, indexD, frameD) {

        // point is an object { x: n, y: n, progress: n, index: n }
        // point.progress is progress of point (0..1)
        // relative to other points in that single draw

        // indexD is relative to the drawn shape (the tail)
        // frameD is the current frame (0..1)
        // pointIndex is the the point's overall index within the points array

        if (point.index < this.frame) {
            this._.globalAlpha = 1;
            this._.beginPath();
            this._.moveTo(point.x, point.y);
            this._.arc(point.x, point.y, 2, 0, Math.PI*2, false);
            this._.closePath();
            this._.fill();
        }

    }

});

start = +(new Date);

timeout.play();

document.body.appendChild(timeout.canvas);

document.addEventListener('click', function () {
    timeout.stop();
    timeout.frame = 0;
    // timeout.play();
});

</script>

</body>