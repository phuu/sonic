<!doctype html>
<meta charset="utf-8" />
<title>Sonic</title>
<meta name="viewport" content="width=device-width">
<meta name="apple-mobile-web-app-capable" content="yes" />

<style>
body {background: black;}
</style>

<body>

<script src="../src/sonic.js"></script>
<script>

var start;

var timeout = new Sonic({

    width: 200,
    height: 200,
    padding: 0,

    fillColor: '#bada55',

    pointDistance: .01,
    time: 5,
    trailLength: 1,

    path: [
        ['line', 40, 30, 150, 30],
        ['arc', 150, 60, 30, -90, 90],
        ['line', 150, 90, 40, 90],
        ['arc', 40, 60, 30, 90, 270],
    ],

    complete: function () {
        this.stop();
        setTimeout(function () {
            start = +(new Date);
            timeout.play();
        }, 500);
        console.log(this.points.length, this.frame);
        console.log('%dms', +(new Date) - start);
    },

    step: function(point, indexD, frameD) {

        // point is an object { x: n, y: n, progress: n, index: n }
        // point.progress is progress of point (0..1)
        // relative to other points in that single draw

        // indexD is relative to the drawn shape (the tail)
        // frameD is the current frame (0..1)
        // pointIndex is the the point's overall index within the points array

        if (point.index < this.frame) {
            this._.globalAlpha = 1;
            this._.beginPath();
            this._.moveTo(point.x, point.y);
            this._.arc(point.x, point.y, 3, 0, Math.PI*2, false);
            this._.closePath();
            this._.fill();
        }

    }

});

start = +(new Date);

timeout.play();

document.body.appendChild(timeout.canvas);

</script>

</body>